<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>LLaMA3 Chat Playground</title>

<style>
:root {
    --bg: #0f172a;
    --panel: #020617;
    --user: #2563eb;
    --assistant: #16a34a;
    --text: #e5e7eb;
    --muted: #94a3b8;
}

* {
    box-sizing: border-box;
    font-family: "Segoe UI", Pretendard, sans-serif;
}

body {
    margin: 0;
    background: var(--bg);
    color: var(--text);
}

.container {
    max-width: 900px;
    margin: auto;
    display: flex;
    flex-direction: column;
    height: 100vh;
}

/* ===== Header ===== */
header {
    padding: 14px 20px;
    background: #020617;
    font-size: 18px;
    font-weight: bold;
    border-bottom: 1px solid #1e293b;
}

/* ===== Chat Area ===== */
.chat-box {
    flex: 1;
    overflow-y: auto;
    padding: 20px;
}

/* Message bubble */
.message {
    max-width: 70%;
    padding: 12px 16px;
    border-radius: 16px;
    margin-bottom: 12px;
    line-height: 1.5;
    word-wrap: break-word;
}

.message.user {
    background: var(--user);
    margin-left: auto;
    border-bottom-right-radius: 4px;
}

.message.assistant {
    background: #1e293b;
    margin-right: auto;
    border-bottom-left-radius: 4px;
}

/* ===== Input ===== */
.input-area {
    display: flex;
    gap: 10px;
    padding: 14px;
    border-top: 1px solid #1e293b;
    background: var(--panel);
}

.input-area textarea {
    flex: 1;
    resize: none;
    padding: 12px;
    border-radius: 10px;
    border: none;
    background: #020617;
    color: var(--text);
}

.input-area button {
    padding: 0 20px;
    border: none;
    border-radius: 10px;
    background: var(--user);
    color: white;
    cursor: pointer;
}

/* ===== Settings Panel ===== */
details {
    background: #020617;
    border-top: 1px solid #1e293b;
}

summary {
    padding: 14px;
    cursor: pointer;
    font-weight: bold;
}

.settings {
    padding: 16px;
}

.settings label {
    font-size: 13px;
    color: var(--muted);
}

.settings input,
.settings textarea {
    width: 100%;
    margin: 6px 0 14px;
    padding: 8px;
    background: #020617;
    border: 1px solid #1e293b;
    color: var(--text);
    border-radius: 8px;
}

.settings button {
    margin-top: 10px;
    padding: 10px 14px;
    border: none;
    border-radius: 8px;
    background: var(--assistant);
    color: white;
    cursor: pointer;
}
</style>

<script>
window.onload = () => {
    const box = document.getElementById("chatBox");
    box.scrollTop = box.scrollHeight;
};
</script>
</head>

<body>
<div class="container">

<header>
    ü¶ô LLaMA3 8B Chat Playground
</header>

<div class="chat-box" id="chatBox">
    {% for msg in chat_history %}
        <div class="message {{ msg.role }}">
            {{ msg.content }}
        </div>
    {% endfor %}
</div>

<!-- Î©îÏãúÏßÄ ÏûÖÎ†• -->
<form method="post" class="input-area">
    <textarea name="prompt" rows="2" placeholder="Î©îÏãúÏßÄÎ•º ÏûÖÎ†•ÌïòÏÑ∏Ïöî..."></textarea>
    <input type="hidden" name="action" value="send_message">
    <button type="submit">Send</button>
</form>

<!-- ÏÑ§Ï†ï Ìå®ÎÑê -->
<details>
<summary>‚öôÔ∏è System Prompt & Hyper Parameters</summary>

<form method="post" class="settings">
    <label>System Prompt</label>
    <textarea name="system_prompt" rows="4">{{ system_prompt }}</textarea>

    <label>Temperature</label>
    <input type="range" name="temperature" min="0.1" max="1.5" step="0.1"
           value="{{ params.temperature }}">

    <label>Top-p</label>
    <input type="range" name="top_p" min="0.1" max="1" step="0.05"
           value="{{ params.top_p }}">

    <label>Top-k</label>
    <input type="number" name="top_k" value="{{ params.top_k }}">

    <label>Max Tokens</label>
    <input type="number" name="max_tokens" value="{{ params.max_tokens }}">

    <label>Repetition Penalty</label>
    <input type="range" name="repetition_penalty" min="1" max="1.5" step="0.05"
           value="{{ params.repetition_penalty }}">

    <input type="hidden" name="action" value="apply_params">
    <button type="submit">Apply Settings</button>
</form>
</details>

</div>
</body>
</html>
