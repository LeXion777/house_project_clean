{% extends "layout.html" %}
{% block title %}정부지원 정책{% endblock %}

{% block page_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/support.css') }}">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css"/>
{% endblock %}

{% block content %}
<div class="hero-wrapper">
    <div class="hero-content">
        <h1>정부지원 정책 조회</h1>
        <p>청년·신혼부부 지원 정책을 한눈에 보고, 쉽게 찾아보세요.</p>
    </div>
</div>

<div class="container-fluid mt-5 support-page px-2"> <!-- px-2로 좌우 살짝 패딩 -->

    <!-- 필터 영역 -->
    <div class="filter-area">
        <div class="d-flex gap-2 align-items-end flex-wrap">
            <div>
                <label class="form-label fw-bold">지역</label>
                <select name="si" class="form-select form-select-lg">
                    <option value="서울시" selected>서울시</option>
                </select>
            </div>

            <div>
                <label class="form-label fw-bold">구</label>
                <select name="district" class="form-select form-select-lg">
                    <option value="">선택</option>
                    {% for d in ["강남구","강동구","강북구","강서구","관악구","광진구","구로구","금천구",
                                 "노원구","도봉구","동대문구","동작구","마포구","서대문구","서초구",
                                 "성동구","성북구","송파구","양천구","영등포구","용산구","은평구",
                                 "종로구","중구","중랑구"] %}
                    <option>{{ d }}</option>
                    {% endfor %}
                </select>
            </div>
        </div>

        <div class="mt-3">
            <label class="form-label fw-bold">구분</label>
            <div class="btn-group btn-group-lg d-flex flex-wrap">
                {% set biz_list = ["금융지원","주택공급","주거비지원","기타"] %}
                {% for biz in biz_list %}
                <input type="checkbox" class="btn-check"
                       value="{{ biz }}" name="business_type1"
                       id="biz{{ loop.index }}">
                <label class="btn btn-outline-type" for="biz{{ loop.index }}">{{ biz }}</label>
                {% endfor %}
            </div>
        </div>

        <button type="button" class="btn btn-reset btn-sm" id="reset-filters">↺ 초기화</button>
    </div>

    <!-- 정책 슬라이더 영역 -->
    {% for section in ["청년", "신혼부부"] %}
    <h4 class="fw-bold section-title mt-5">{{ section }} 지원 정책</h4>
    <div class="swiper sp-swiper-{{ section | lower }} mt-3 px-1"> <!-- px-1로 슬라이드 좌우 여백 -->
        <div class="swiper-wrapper">
            {% set items_filtered = items | selectattr("target_type","equalto",section) | list %}
            {% set items_all = items | selectattr("target_type","equalto","전체") | list %}
            {% for item in items_filtered + items_all %}
            <div class="swiper-slide sp-slide">
                <div class="sp-card"
                     data-biz="{{ item.business_type1 }}"
                     data-id="{{ item.id }}"
                     data-source="list">
                    <h5 class="sp-title">{{ item.title }}</h5>
                    <p class="sp-subtitle">{{ item.detail_json.subtitle }}</p>
                    <div class="sp-badges">
                        <span class="badge badge-blue">{{ item.target_type }}</span>
                        <span class="badge badge-orange">{{ item.business_type1 }}</span>
                    </div>
                    <a href="{{ url_for('support.detail_view', pid=item.id, source='list', target=item.target_type, biz=item.business_type1) }}"
                       class="btn sp-btn-detail
                              {% if item.target_type == '청년' and item.business_type1 == '주택공급' %}youth-btn{% endif %}
                              {% if item.target_type == '신혼부부' and item.business_type1 == '주택공급' %}newlywed-btn{% endif %}">
                        자세히 보기
                    </a>


                </div>
            </div>
            {% endfor %}
        </div>

        <div class="swiper-button-prev sp-prev-{{ section | lower }}"></div>
        <div class="swiper-button-next sp-next-{{ section | lower }}"></div>
    </div>
    {% endfor %}
</div>
{% endblock %}

{% block extra_js %}
<script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
<script src="{{ url_for('static', filename='js/support.js') }}"></script>
{% endblock %}
